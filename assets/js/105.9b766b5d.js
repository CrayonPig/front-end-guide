(window.webpackJsonp=window.webpackJsonp||[]).push([[105],{448:function(t,s,n){"use strict";n.r(s);var a=n(14),e=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"卡顿监控"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#卡顿监控"}},[t._v("#")]),t._v(" 卡顿监控")]),t._v(" "),s("p",[t._v("卡顿监控是指对网站的性能进行监控，从而识别用户在使用网站时所遇到的卡顿问题。卡顿通常是由于网站在执行复杂的JavaScript操作或渲染大量内容时导致的（常见的涉及到动画、列表渲染的场景），这会使得页面加载速度变慢，影响用户的体验。")]),t._v(" "),s("p",[t._v("卡顿监控的原理是通过测量页面的响应时间和FPS（每秒帧数）来判断用户是否遇到了卡顿问题。")]),t._v(" "),s("p",[t._v("FPS是Frames Per Second的缩写，意为每秒帧数，是指显示器每秒钟能够显示的图像帧数。在计算机图形学和动画制作中，FPS是一个重要的指标，它决定了画面的流畅度和清晰度。在前端开发中，浏览器的FPS是一个重要的指标，它反映了页面的性能和用户体验。通常来说，页面的FPS应该保持在60FPS或以上，以保证页面的流畅度和响应速度。")]),t._v(" "),s("h2",{attrs:{id:"实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实现"}},[t._v("#")]),t._v(" 实现")]),t._v(" "),s("p",[t._v("浏览器提供了Performance API和requestAnimationFrame API来测量页面的响应时间和FPS。通过在这两个API中设置时间戳，我们可以计算出每帧所需要的时间，从而判断是否有卡顿现象。具体的实现方式可以参考下面的代码：")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" fps "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 帧率")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" frameTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" fps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 每帧所需的时间")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" lastFrameTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 上一帧的时间戳")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("checkFps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("currentTime")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" elapsed "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" currentTime "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" lastFrameTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 计算两帧之间的时间差")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elapsed "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" frameTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果时间差超过了每帧所需的时间，说明页面出现了卡顿")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("warn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'页面出现卡顿现象！'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("requestAnimationFrame")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("checkFps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("requestAnimationFrame")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("checkFps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")]),s("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[s("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1727574017591-44545"}},[t._v("成功")]),s("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"let fps = 60; // 帧率\nlet frameTime = 1000 / fps; // 每帧所需的时间\nlet lastFrameTime = 0; // 上一帧的时间戳\n\nfunction checkFps(currentTime) {\n  const elapsed = currentTime - lastFrameTime; // 计算两帧之间的时间差\n  if (elapsed > frameTime) {\n    // 如果时间差超过了每帧所需的时间，说明页面出现了卡顿\n    console.warn('页面出现卡顿现象！');\n  }\n  requestAnimationFrame(checkFps);\n}\n\nrequestAnimationFrame(checkFps);\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1727574017591-44545","data-mdic-notify-delay":"2000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("复制代码")])])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br")])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("requestAnimationFrame是一种浏览器提供的JavaScript函数，它可以让我们在下一次重绘之前执行指定的函数。通常情况下，requestAnimationFrame的调用频率与浏览器的刷新率相同，即一秒钟60次。")])]),t._v(" "),s("h2",{attrs:{id:"常见卡顿原因"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常见卡顿原因"}},[t._v("#")]),t._v(" 常见卡顿原因")]),t._v(" "),s("ol",[s("li",[s("p",[s("strong",[t._v("网络问题")]),t._v("\n如果前端资源文件过大或者网络请求过多，就会导致前端页面的加载速度变慢，从而出现卡顿的现象。这种情况可以通过减小资源文件的体积或者优化网络请求的方式来解决。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("JS代码问题")]),t._v("\nJS代码过于复杂或者存在死循环等问题也会导致前端页面出现卡顿的现象。这种情况可以通过优化JS代码或者检查代码中的死循环问题来解决。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("CSS样式问题")]),t._v("\n如果CSS样式存在大量的层叠或者过于复杂，也会导致前端页面出现卡顿的现象。这种情况可以通过优化CSS样式或者使用CSS预编译器来解决。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("渲染问题")]),t._v("\n浏览器的渲染引擎也会影响前端页面的卡顿情况。当页面中存在大量的DOM元素或者复杂的布局时，浏览器会消耗更多的计算资源，从而导致页面卡顿。这种情况可以通过减少DOM元素数量或者使用虚拟滚动等技术来解决。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("设备问题")]),t._v("\n前端卡顿也可能是由于设备本身的问题导致的，例如设备内存不足或者处理器性能不足等。这种情况可以通过升级硬件或者减少前端页面的复杂度来解决。")])])]),t._v(" "),s("h2",{attrs:{id:"常见解决方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常见解决方式"}},[t._v("#")]),t._v(" 常见解决方式")]),t._v(" "),s("ol",[s("li",[s("p",[s("strong",[t._v("图片懒加载")]),t._v("\n当用户滚动到图片位置时再进行加载，避免在页面初始加载时全部加载导致性能下降。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("压缩文件")]),t._v("\n使用压缩工具来压缩JS、CSS等文件，减少文件体积，提高页面加载速度。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("使用缓存")]),t._v("\n对于经常使用的资源文件，可以使用缓存机制来提高加载速度。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("减少HTTP请求")]),t._v("\n对于不必要的HTTP请求，例如请求重复的资源文件或者跨域请求，可以减少请求次数来提高性能。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("使用Web Workers")]),t._v("\nWeb Workers可以将一些计算密集型的任务转移到后台线程中，避免阻塞主线程，从而提高页面性能。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("虚拟滚动")]),t._v("\n虚拟滚动用于处理大量数据列表的渲染问题，会动态地加载和卸载元素，从而减少浏览器的渲染负担。")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);