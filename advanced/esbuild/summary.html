<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>调用总结 | 前端工程化详解</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="前端工程化详解;开箱即用的前端工程化方案;前端代码规范;使用过程中如碰到问题，请到Github进行提问。 https://github.com/CrayonPig/front-end-guide">
    
    <link rel="preload" href="/assets/css/0.styles.96eb8417.css" as="style"><link rel="preload" href="/assets/js/app.96c97f9f.js" as="script"><link rel="preload" href="/assets/js/2.127a83d1.js" as="script"><link rel="preload" href="/assets/js/1.c207c03b.js" as="script"><link rel="preload" href="/assets/js/51.d23988c8.js" as="script"><link rel="prefetch" href="/assets/js/10.e765ec60.js"><link rel="prefetch" href="/assets/js/100.3e91ff8b.js"><link rel="prefetch" href="/assets/js/101.208b6657.js"><link rel="prefetch" href="/assets/js/102.39abd6d5.js"><link rel="prefetch" href="/assets/js/103.8e979cb1.js"><link rel="prefetch" href="/assets/js/104.d3df55b4.js"><link rel="prefetch" href="/assets/js/105.5ffc8d48.js"><link rel="prefetch" href="/assets/js/106.128c2fdb.js"><link rel="prefetch" href="/assets/js/107.50b7b0c7.js"><link rel="prefetch" href="/assets/js/108.ef7631c7.js"><link rel="prefetch" href="/assets/js/109.7a88fbe9.js"><link rel="prefetch" href="/assets/js/11.1c1ed2bd.js"><link rel="prefetch" href="/assets/js/110.d25e785b.js"><link rel="prefetch" href="/assets/js/111.215b354a.js"><link rel="prefetch" href="/assets/js/112.730c3080.js"><link rel="prefetch" href="/assets/js/113.f34007c5.js"><link rel="prefetch" href="/assets/js/114.618b4413.js"><link rel="prefetch" href="/assets/js/115.1b096c6c.js"><link rel="prefetch" href="/assets/js/116.0436d8c5.js"><link rel="prefetch" href="/assets/js/117.6b53dba1.js"><link rel="prefetch" href="/assets/js/118.8733ca24.js"><link rel="prefetch" href="/assets/js/119.9199638f.js"><link rel="prefetch" href="/assets/js/12.09ff163d.js"><link rel="prefetch" href="/assets/js/120.eddbfc1d.js"><link rel="prefetch" href="/assets/js/121.7aa515a2.js"><link rel="prefetch" href="/assets/js/122.383d99ec.js"><link rel="prefetch" href="/assets/js/123.b2a60d2d.js"><link rel="prefetch" href="/assets/js/124.0ff92d93.js"><link rel="prefetch" href="/assets/js/125.c7aa500b.js"><link rel="prefetch" href="/assets/js/126.308fda88.js"><link rel="prefetch" href="/assets/js/127.c8e542f2.js"><link rel="prefetch" href="/assets/js/13.0bf85bae.js"><link rel="prefetch" href="/assets/js/14.46e84065.js"><link rel="prefetch" href="/assets/js/15.da16365c.js"><link rel="prefetch" href="/assets/js/16.23e15069.js"><link rel="prefetch" href="/assets/js/17.33e0a674.js"><link rel="prefetch" href="/assets/js/18.7970dc9e.js"><link rel="prefetch" href="/assets/js/19.fbd34b66.js"><link rel="prefetch" href="/assets/js/20.c2befb88.js"><link rel="prefetch" href="/assets/js/21.5a27cae7.js"><link rel="prefetch" href="/assets/js/22.22891883.js"><link rel="prefetch" href="/assets/js/23.c3e80bd4.js"><link rel="prefetch" href="/assets/js/24.b7935586.js"><link rel="prefetch" href="/assets/js/25.0bc345c6.js"><link rel="prefetch" href="/assets/js/26.e9d5ff15.js"><link rel="prefetch" href="/assets/js/27.fae2915e.js"><link rel="prefetch" href="/assets/js/28.92b6c226.js"><link rel="prefetch" href="/assets/js/29.525efe31.js"><link rel="prefetch" href="/assets/js/3.67e929b6.js"><link rel="prefetch" href="/assets/js/30.f1075416.js"><link rel="prefetch" href="/assets/js/31.ee92a46a.js"><link rel="prefetch" href="/assets/js/32.4e45196d.js"><link rel="prefetch" href="/assets/js/33.73656a93.js"><link rel="prefetch" href="/assets/js/34.71f5f938.js"><link rel="prefetch" href="/assets/js/35.79fc3944.js"><link rel="prefetch" href="/assets/js/36.78ef71c4.js"><link rel="prefetch" href="/assets/js/37.ff98b46e.js"><link rel="prefetch" href="/assets/js/38.c23e15a0.js"><link rel="prefetch" href="/assets/js/39.16327cdd.js"><link rel="prefetch" href="/assets/js/4.653f0222.js"><link rel="prefetch" href="/assets/js/40.62c74a8b.js"><link rel="prefetch" href="/assets/js/41.1314da54.js"><link rel="prefetch" href="/assets/js/42.9c3051bd.js"><link rel="prefetch" href="/assets/js/43.c2671738.js"><link rel="prefetch" href="/assets/js/44.ae4a9373.js"><link rel="prefetch" href="/assets/js/45.479e4ebc.js"><link rel="prefetch" href="/assets/js/46.ded43216.js"><link rel="prefetch" href="/assets/js/47.90e20a09.js"><link rel="prefetch" href="/assets/js/48.623a91cd.js"><link rel="prefetch" href="/assets/js/49.86adfe3b.js"><link rel="prefetch" href="/assets/js/5.563ccd5c.js"><link rel="prefetch" href="/assets/js/50.7072aea2.js"><link rel="prefetch" href="/assets/js/52.c0a6957b.js"><link rel="prefetch" href="/assets/js/53.535f4cd8.js"><link rel="prefetch" href="/assets/js/54.53ae8e2b.js"><link rel="prefetch" href="/assets/js/55.578cc068.js"><link rel="prefetch" href="/assets/js/56.0a8c3218.js"><link rel="prefetch" href="/assets/js/57.d9b2187c.js"><link rel="prefetch" href="/assets/js/58.ae69de63.js"><link rel="prefetch" href="/assets/js/59.08e7b57b.js"><link rel="prefetch" href="/assets/js/6.1ef82e4c.js"><link rel="prefetch" href="/assets/js/60.913285d9.js"><link rel="prefetch" href="/assets/js/61.0913b0b4.js"><link rel="prefetch" href="/assets/js/62.e7afc5b2.js"><link rel="prefetch" href="/assets/js/63.816ffc96.js"><link rel="prefetch" href="/assets/js/64.b200d1d6.js"><link rel="prefetch" href="/assets/js/65.5f5a84ca.js"><link rel="prefetch" href="/assets/js/66.3ffd6255.js"><link rel="prefetch" href="/assets/js/67.76cb1775.js"><link rel="prefetch" href="/assets/js/68.53819069.js"><link rel="prefetch" href="/assets/js/69.0a037ad4.js"><link rel="prefetch" href="/assets/js/7.4ea4b605.js"><link rel="prefetch" href="/assets/js/70.d2ee8988.js"><link rel="prefetch" href="/assets/js/71.8280bfa9.js"><link rel="prefetch" href="/assets/js/72.ecd14878.js"><link rel="prefetch" href="/assets/js/73.07702fd7.js"><link rel="prefetch" href="/assets/js/74.70aa2dbc.js"><link rel="prefetch" href="/assets/js/75.934a2f09.js"><link rel="prefetch" href="/assets/js/76.ec56be96.js"><link rel="prefetch" href="/assets/js/77.de9619c3.js"><link rel="prefetch" href="/assets/js/78.346a7bab.js"><link rel="prefetch" href="/assets/js/79.321d1f0a.js"><link rel="prefetch" href="/assets/js/80.e05172c5.js"><link rel="prefetch" href="/assets/js/81.2ea7acb5.js"><link rel="prefetch" href="/assets/js/82.23e5111c.js"><link rel="prefetch" href="/assets/js/83.636f2146.js"><link rel="prefetch" href="/assets/js/84.ac4a60ae.js"><link rel="prefetch" href="/assets/js/85.ede6ffdc.js"><link rel="prefetch" href="/assets/js/86.8cef591d.js"><link rel="prefetch" href="/assets/js/87.964e2440.js"><link rel="prefetch" href="/assets/js/88.86c7df92.js"><link rel="prefetch" href="/assets/js/89.814f4e5e.js"><link rel="prefetch" href="/assets/js/90.1d48dca8.js"><link rel="prefetch" href="/assets/js/91.9631c0e3.js"><link rel="prefetch" href="/assets/js/92.d3fb4239.js"><link rel="prefetch" href="/assets/js/93.4488b418.js"><link rel="prefetch" href="/assets/js/94.faa13813.js"><link rel="prefetch" href="/assets/js/95.a195db9c.js"><link rel="prefetch" href="/assets/js/96.4c4c8042.js"><link rel="prefetch" href="/assets/js/97.8f311454.js"><link rel="prefetch" href="/assets/js/98.3bc5dbe5.js"><link rel="prefetch" href="/assets/js/99.002e523c.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.ae6b1de9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.96eb8417.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">前端工程化详解</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/project/" class="nav-link">
  工程化入门
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工程化进阶" class="dropdown-title"><span class="title">工程化进阶</span> <span class="arrow down"></span></button> <button type="button" aria-label="工程化进阶" class="mobile-dropdown-title"><span class="title">工程化进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advanced/rollup/" class="nav-link">
  Rollup
</a></li><li class="dropdown-item"><!----> <a href="/advanced/esbuild/" class="nav-link router-link-active">
  esbuild
</a></li><li class="dropdown-item"><!----> <a href="/advanced/vite/" class="nav-link">
  Vite
</a></li></ul></div></div><div class="nav-item"><a href="/guide/" class="nav-link">
  代码规范
</a></div><div class="nav-item"><a href="https://origin.duanhl.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  源码分析
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/monitor/" class="nav-link">
  前端监控系统
</a></div><div class="nav-item"><a href="https://github.com/CrayonPig/front-end-guide" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/project/" class="nav-link">
  工程化入门
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工程化进阶" class="dropdown-title"><span class="title">工程化进阶</span> <span class="arrow down"></span></button> <button type="button" aria-label="工程化进阶" class="mobile-dropdown-title"><span class="title">工程化进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advanced/rollup/" class="nav-link">
  Rollup
</a></li><li class="dropdown-item"><!----> <a href="/advanced/esbuild/" class="nav-link router-link-active">
  esbuild
</a></li><li class="dropdown-item"><!----> <a href="/advanced/vite/" class="nav-link">
  Vite
</a></li></ul></div></div><div class="nav-item"><a href="/guide/" class="nav-link">
  代码规范
</a></div><div class="nav-item"><a href="https://origin.duanhl.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  源码分析
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/monitor/" class="nav-link">
  前端监控系统
</a></div><div class="nav-item"><a href="https://github.com/CrayonPig/front-end-guide" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/advanced/esbuild/" aria-current="page" class="sidebar-link">esbuild 概述</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>使用介绍</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/advanced/esbuild/cmd.html" class="sidebar-link">命令行调用</a></li><li><a href="/advanced/esbuild/code.html" class="sidebar-link">代码调用</a></li><li><a href="/advanced/esbuild/summary.html" aria-current="page" class="active sidebar-link">调用总结</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/advanced/esbuild/summary.html#transform-api" class="sidebar-link">transform API</a></li><li class="sidebar-sub-header"><a href="/advanced/esbuild/summary.html#命令行调用" class="sidebar-link">命令行调用</a></li><li class="sidebar-sub-header"><a href="/advanced/esbuild/summary.html#js代码调用" class="sidebar-link">JS代码调用</a></li><li class="sidebar-sub-header"><a href="/advanced/esbuild/summary.html#context-api" class="sidebar-link">Context API</a></li><li class="sidebar-sub-header"><a href="/advanced/esbuild/summary.html#完整案例" class="sidebar-link">完整案例</a></li></ul></li></ul></section></li><li><a href="/advanced/esbuild/plugin.html" class="sidebar-link">插件开发</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="调用总结"><a href="#调用总结" class="header-anchor">#</a> 调用总结</h1> <h2 id="transform-api"><a href="#transform-api" class="header-anchor">#</a> transform API</h2> <p><code>transform/transformSync</code> 对单个字符串进行操作，不需要访问文件系统。非常适合在没有文件系统的环境中使用或作为另一个工具链的一部分，它提供了两个参数：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token function">transform</span><span class="token punctuation">(</span>str<span class="token operator">:</span> string<span class="token punctuation">,</span> options<span class="token operator">?</span><span class="token operator">:</span> Config<span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>Result<span class="token operator">&gt;</span>
<span class="token function">transformSync</span><span class="token punctuation">(</span>str<span class="token operator">:</span> string<span class="token punctuation">,</span> options<span class="token operator">?</span><span class="token operator">:</span> Config<span class="token punctuation">)</span><span class="token operator">:</span> Result
</code><div class="m-mdic-copy-wrapper"><div class="u-mdic-copy-notify" id="j-notify-1726223536986-16809">成功</div><button class="u-mdic-copy-btn j-mdic-copy-btn" data-mdic-content="transform(str: string, options?: Config): Promise&lt;Result&gt;
transformSync(str: string, options?: Config): Result
" data-mdic-attach-content="" data-mdic-notify-id="j-notify-1726223536986-16809" data-mdic-notify-delay="2000" data-mdic-copy-fail-text="copy fail" onclick="!function(t){const e={copy:(t='',e='')=&gt;new Promise((c,o)=&gt;{const n=document.createElement('textarea'),d=e?`\n\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&amp;&amp;t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=&gt;{n.style.display='block',setTimeout(()=&gt;{n.style.display='none'},d)}).catch(()=&gt;{alert(i)})}};e.btnClick(t)}(this);">复制代码</button></div></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol><li><code>str</code>：字符串（必填），指需要转化的代码</li> <li><code>options</code>：配置项（可选），指转化需要的选项</li></ol> <p>常用配置：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">interface</span> <span class="token class-name">Config</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">define</span><span class="token operator">:</span> object # 关键词替换
  <span class="token literal-property property">format</span><span class="token operator">:</span> string # js 输出规范（iife<span class="token operator">/</span>cjs<span class="token operator">/</span>esm）
  <span class="token literal-property property">loader</span><span class="token operator">:</span> string <span class="token operator">|</span> object # transform <span class="token constant">API</span> 只能使用 string
  <span class="token literal-property property">minify</span><span class="token operator">:</span> boolean # 压缩代码，包含删除空格、重命名变量、修改语法使语法更简练
  # 通过以下方式单独配置，上述功能
  <span class="token literal-property property">minifyWhitespace</span><span class="token operator">:</span> boolean # 删除空格
  <span class="token literal-property property">minifyIdentifiers</span><span class="token operator">:</span> boolean # 重命名变量
  <span class="token literal-property property">minifySyntax</span><span class="token operator">:</span> boolean # 修改语法使语法更简练
  <span class="token literal-property property">sourcemap</span><span class="token operator">:</span> boolean <span class="token operator">|</span> string
  <span class="token literal-property property">target</span><span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span> # 设置目标环境，默认是 esnext（使用最新 es 特性）
<span class="token punctuation">}</span>
</code><div class="m-mdic-copy-wrapper"><div class="u-mdic-copy-notify" id="j-notify-1726223536986-62873">成功</div><button class="u-mdic-copy-btn j-mdic-copy-btn" data-mdic-content="interface Config {
  define: object # 关键词替换
  format: string # js 输出规范（iife/cjs/esm）
  loader: string | object # transform API 只能使用 string
  minify: boolean # 压缩代码，包含删除空格、重命名变量、修改语法使语法更简练
  # 通过以下方式单独配置，上述功能
  minifyWhitespace: boolean # 删除空格
  minifyIdentifiers: boolean # 重命名变量
  minifySyntax: boolean # 修改语法使语法更简练
  sourcemap: boolean | string
  target: string[] # 设置目标环境，默认是 esnext（使用最新 es 特性）
}
" data-mdic-attach-content="" data-mdic-notify-id="j-notify-1726223536986-62873" data-mdic-notify-delay="2000" data-mdic-copy-fail-text="copy fail" onclick="!function(t){const e={copy:(t='',e='')=&gt;new Promise((c,o)=&gt;{const n=document.createElement('textarea'),d=e?`\n\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&amp;&amp;t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=&gt;{n.style.display='block',setTimeout(()=&gt;{n.style.display='none'},d)}).catch(()=&gt;{alert(i)})}};e.btnClick(t)}(this);">复制代码</button></div></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// transform.mjs</span>

<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> esbuild <span class="token keyword">from</span> <span class="token string">'esbuild'</span>
<span class="token keyword">const</span> code <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
interface User{
  name: string;
  age: number;
}
let x: number = 1;
const getUserInfo = (user: User) =&gt; {
  console.log(user.name);
  console.log(user.age);
}
getUserInfo({name: 'jack', age: 18});
</span><span class="token template-punctuation string">`</span></span>

<span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> esbuild<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'ts'</span><span class="token punctuation">,</span>
  <span class="token comment">// minify: true,</span>
  <span class="token comment">// minifyWhitespace: true,</span>
  <span class="token comment">// sourcemap: true,</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code><div class="m-mdic-copy-wrapper"><div class="u-mdic-copy-notify" id="j-notify-1726223536986-61606">成功</div><button class="u-mdic-copy-btn j-mdic-copy-btn" data-mdic-content="// transform.mjs

import * as esbuild from 'esbuild'
const code = `
interface User{
  name: string;
  age: number;
}
let x: number = 1;
const getUserInfo = (user: User) =&gt; {
  console.log(user.name);
  console.log(user.age);
}
getUserInfo({name: 'jack', age: 18});
`

let result = await esbuild.transform(code, {
  loader: 'ts',
  // minify: true,
  // minifyWhitespace: true,
  // sourcemap: true,

})
console.log(result)
" data-mdic-attach-content="" data-mdic-notify-id="j-notify-1726223536986-61606" data-mdic-notify-delay="2000" data-mdic-copy-fail-text="copy fail" onclick="!function(t){const e={copy:(t='',e='')=&gt;new Promise((c,o)=&gt;{const n=document.createElement('textarea'),d=e?`\n\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&amp;&amp;t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=&gt;{n.style.display='block',setTimeout(()=&gt;{n.style.display='none'},d)}).catch(()=&gt;{alert(i)})}};e.btnClick(t)}(this);">复制代码</button></div></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="命令行调用"><a href="#命令行调用" class="header-anchor">#</a> 命令行调用</h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code># 入口文件 esbuild xxx<span class="token operator">/</span>index<span class="token punctuation">.</span>ts
# <span class="token operator">--</span>outfile<span class="token operator">=</span>xxx<span class="token operator">/</span>xxx<span class="token operator">/</span>js 输出文件
# <span class="token operator">--</span>outdir<span class="token operator">=</span>xxx<span class="token operator">/</span> 输出目录
# <span class="token operator">--</span>bundle 打包
# <span class="token operator">--</span>minify 压缩
# <span class="token operator">--</span>target<span class="token operator">=</span>esnext
# <span class="token operator">--</span>loader<span class="token operator">:</span><span class="token punctuation">.</span>png<span class="token operator">=</span>dataurl 将 png 转换成dataurl的形式
</code><div class="m-mdic-copy-wrapper"><div class="u-mdic-copy-notify" id="j-notify-1726223536986-59744">成功</div><button class="u-mdic-copy-btn j-mdic-copy-btn" data-mdic-content="# 入口文件 esbuild xxx/index.ts
# --outfile=xxx/xxx/js 输出文件
# --outdir=xxx/ 输出目录
# --bundle 打包
# --minify 压缩
# --target=esnext
# --loader:.png=dataurl 将 png 转换成dataurl的形式
" data-mdic-attach-content="" data-mdic-notify-id="j-notify-1726223536986-59744" data-mdic-notify-delay="2000" data-mdic-copy-fail-text="copy fail" onclick="!function(t){const e={copy:(t='',e='')=&gt;new Promise((c,o)=&gt;{const n=document.createElement('textarea'),d=e?`\n\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&amp;&amp;t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=&gt;{n.style.display='block',setTimeout(()=&gt;{n.style.display='none'},d)}).catch(()=&gt;{alert(i)})}};e.btnClick(t)}(this);">复制代码</button></div></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="js代码调用"><a href="#js代码调用" class="header-anchor">#</a> JS代码调用</h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>Build <span class="token constant">API</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> esbuild<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
esbuild<span class="token punctuation">.</span><span class="token function">buildSync</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//同步方法</span>
<span class="token comment">//esbuild.watch()</span>
<span class="token comment">//esbuild.serve()</span>
<span class="token keyword">const</span> ctx <span class="token operator">=</span> <span class="token keyword">await</span> esbuild<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span> esbuid v<span class="token punctuation">.</span><span class="token number">0.17</span>
<span class="token comment">//监听文件</span>
<span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//开发服务器</span>
<span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">serve</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//重新打包</span>
<span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">rebuild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div class="m-mdic-copy-wrapper"><div class="u-mdic-copy-notify" id="j-notify-1726223536986-92024">成功</div><button class="u-mdic-copy-btn j-mdic-copy-btn" data-mdic-content="Build API
const config = {};
await esbuild.build(config);
esbuild.buildSync(config); //同步方法
//esbuild.watch()
//esbuild.serve()
const ctx = await esbuild.context(config) esbuid v.0.17
//监听文件
await ctx.watch();
//开发服务器
await ctx.serve({});
//重新打包
await ctx.rebuild();
" data-mdic-attach-content="" data-mdic-notify-id="j-notify-1726223536986-92024" data-mdic-notify-delay="2000" data-mdic-copy-fail-text="copy fail" onclick="!function(t){const e={copy:(t='',e='')=&gt;new Promise((c,o)=&gt;{const n=document.createElement('textarea'),d=e?`\n\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&amp;&amp;t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=&gt;{n.style.display='block',setTimeout(()=&gt;{n.style.display='none'},d)}).catch(()=&gt;{alert(i)})}};e.btnClick(t)}(this);">复制代码</button></div></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="build-api"><a href="#build-api" class="header-anchor">#</a> build API</h3> <p>Build API调用对文件系统中的一个或多个文件进行操作。这使得文件可以相互引用，并被编译在一起（需要设置<code>bundle: true</code>）</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token function">build</span><span class="token punctuation">(</span>options<span class="token operator">?</span><span class="token operator">:</span> Config<span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>Result<span class="token operator">&gt;</span>
<span class="token function">buildSync</span><span class="token punctuation">(</span>options<span class="token operator">?</span><span class="token operator">:</span> Config<span class="token punctuation">)</span><span class="token operator">:</span> Result
</code><div class="m-mdic-copy-wrapper"><div class="u-mdic-copy-notify" id="j-notify-1726223536986-12688">成功</div><button class="u-mdic-copy-btn j-mdic-copy-btn" data-mdic-content="build(options?: Config): Promise&lt;Result&gt;
buildSync(options?: Config): Result
" data-mdic-attach-content="" data-mdic-notify-id="j-notify-1726223536986-12688" data-mdic-notify-delay="2000" data-mdic-copy-fail-text="copy fail" onclick="!function(t){const e={copy:(t='',e='')=&gt;new Promise((c,o)=&gt;{const n=document.createElement('textarea'),d=e?`\n\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&amp;&amp;t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=&gt;{n.style.display='block',setTimeout(()=&gt;{n.style.display='none'},d)}).catch(()=&gt;{alert(i)})}};e.btnClick(t)}(this);">复制代码</button></div></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>常用配置：</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// ./node_modules/esbuild/lib/main.d.ts</span>

<span class="token keyword">interface</span> <span class="token class-name">CommonOptions</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">absWorkingDir</span><span class="token operator">:</span> string # 当前项目根目录，可通过process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>设置
  <span class="token literal-property property">bundle</span><span class="token operator">:</span> boolean # 将所有源码打包到一起
  <span class="token literal-property property">entryPoints</span><span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> object # 入口文件，通过对象方式可以指定输出后文件名，和 webpack 类似
  <span class="token literal-property property">outdir</span><span class="token operator">:</span> string # 输出文件夹，不能和 outfile 同时使用；多入口文件使用 outdir
  <span class="token literal-property property">outfile</span><span class="token operator">:</span> string # 输出的文件名，，不能和 outdir 同时使用；单入口文件使用 outfile
  <span class="token literal-property property">outbase</span><span class="token operator">:</span> string # 每个入口文件构建到不同目录时使用
  <span class="token literal-property property">define</span><span class="token operator">:</span> object # define <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token constant">K</span><span class="token operator">:</span> <span class="token constant">V</span><span class="token punctuation">}</span>  在解析代码的时候用<span class="token constant">V</span>替换<span class="token constant">K</span> 
  <span class="token literal-property property">platform</span><span class="token operator">:</span> string # 指定输出环境，默认为 browser 还有一个值是 node，
  <span class="token literal-property property">format</span><span class="token operator">:</span> string # js 输出规范（iife<span class="token operator">/</span>cjs<span class="token operator">/</span>esm），如果 platform 为 browser，默认为 iife；如果 platform 为 node，默认为 cjs
  <span class="token literal-property property">splitting</span><span class="token operator">:</span> boolean # <span class="token function">代码分割</span><span class="token punctuation">(</span>当前仅限 esm模式<span class="token punctuation">,</span>还在迭代中<span class="token operator">...</span><span class="token punctuation">)</span>
  <span class="token literal-property property">loader</span><span class="token operator">:</span> string <span class="token operator">|</span> object # transform <span class="token constant">API</span> 只能使用 string
  <span class="token literal-property property">minify</span><span class="token operator">:</span> boolean # 压缩代码，包含删除空格、重命名变量、修改语法使语法更简练。其实就是下面三个配置的整合体minifyWhitespace，minifyIdentifiers，minifySyntax
  <span class="token literal-property property">minifyWhitespace</span><span class="token operator">:</span> boolean # 删除空格
  <span class="token literal-property property">minifyIdentifiers</span><span class="token operator">:</span> boolean # 重命名变量
  <span class="token literal-property property">minifySyntax</span><span class="token operator">:</span> boolean # 修改语法使语法更简练
  <span class="token literal-property property">sourcemap</span><span class="token operator">:</span> boolean <span class="token operator">|</span> string
  <span class="token literal-property property">target</span><span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span> # 设置目标环境，默认是 esnext（使用最新 es 特性）
  <span class="token literal-property property">jsxFactory</span><span class="token operator">:</span> string # 指定调用每个jsx元素的函数
  <span class="token literal-property property">jsxFragment</span><span class="token operator">:</span> string # 指定聚合一个子元素列表的函数
  <span class="token literal-property property">assetNames</span><span class="token operator">:</span> string # 静态资源输出的文件名称（默认是名字加上hash）
  <span class="token literal-property property">chunkNames</span><span class="token operator">:</span> string # 代码分割后输出的文件名称
  <span class="token literal-property property">entryNames</span><span class="token operator">:</span> string # 入口文件名称
  <span class="token literal-property property">treeShaking</span><span class="token operator">:</span> boolean # 默认为<span class="token boolean">true</span>
  <span class="token literal-property property">tsconfig</span><span class="token operator">:</span> string # 指定 tsconfig 文件
  <span class="token literal-property property">publicPath</span><span class="token operator">:</span> string # 公共路径
  <span class="token literal-property property">write</span><span class="token operator">:</span> boolean # 默认 <span class="token boolean">false</span>，对于cli和js <span class="token constant">API</span>，默认是写入文件系统中，设置为 <span class="token boolean">true</span> 后，写入内存缓冲区
  <span class="token literal-property property">inject</span><span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span> # 将数组中的文件导入到所有输出文件中
  <span class="token literal-property property">metafile</span><span class="token operator">:</span> boolean # 生成依赖图 
<span class="token punctuation">}</span>
</code><div class="m-mdic-copy-wrapper"><div class="u-mdic-copy-notify" id="j-notify-1726223536986-99454">成功</div><button class="u-mdic-copy-btn j-mdic-copy-btn" data-mdic-content="// ./node_modules/esbuild/lib/main.d.ts

interface CommonOptions {
  absWorkingDir: string # 当前项目根目录，可通过process.cwd()设置
  bundle: boolean # 将所有源码打包到一起
  entryPoints: string[] | object # 入口文件，通过对象方式可以指定输出后文件名，和 webpack 类似
  outdir: string # 输出文件夹，不能和 outfile 同时使用；多入口文件使用 outdir
  outfile: string # 输出的文件名，，不能和 outdir 同时使用；单入口文件使用 outfile
  outbase: string # 每个入口文件构建到不同目录时使用
  define: object # define = {K: V}  在解析代码的时候用V替换K 
  platform: string # 指定输出环境，默认为 browser 还有一个值是 node，
  format: string # js 输出规范（iife/cjs/esm），如果 platform 为 browser，默认为 iife；如果 platform 为 node，默认为 cjs
  splitting: boolean # 代码分割(当前仅限 esm模式,还在迭代中...)
  loader: string | object # transform API 只能使用 string
  minify: boolean # 压缩代码，包含删除空格、重命名变量、修改语法使语法更简练。其实就是下面三个配置的整合体minifyWhitespace，minifyIdentifiers，minifySyntax
  minifyWhitespace: boolean # 删除空格
  minifyIdentifiers: boolean # 重命名变量
  minifySyntax: boolean # 修改语法使语法更简练
  sourcemap: boolean | string
  target: string[] # 设置目标环境，默认是 esnext（使用最新 es 特性）
  jsxFactory: string # 指定调用每个jsx元素的函数
  jsxFragment: string # 指定聚合一个子元素列表的函数
  assetNames: string # 静态资源输出的文件名称（默认是名字加上hash）
  chunkNames: string # 代码分割后输出的文件名称
  entryNames: string # 入口文件名称
  treeShaking: boolean # 默认为true
  tsconfig: string # 指定 tsconfig 文件
  publicPath: string # 公共路径
  write: boolean # 默认 false，对于cli和js API，默认是写入文件系统中，设置为 true 后，写入内存缓冲区
  inject: string[] # 将数组中的文件导入到所有输出文件中
  metafile: boolean # 生成依赖图 
}
" data-mdic-attach-content="" data-mdic-notify-id="j-notify-1726223536986-99454" data-mdic-notify-delay="2000" data-mdic-copy-fail-text="copy fail" onclick="!function(t){const e={copy:(t='',e='')=&gt;new Promise((c,o)=&gt;{const n=document.createElement('textarea'),d=e?`\n\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&amp;&amp;t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=&gt;{n.style.display='block',setTimeout(()=&gt;{n.style.display='none'},d)}).catch(()=&gt;{alert(i)})}};e.btnClick(t)}(this);">复制代码</button></div></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h3 id="加载器-loader"><a href="#加载器-loader" class="header-anchor">#</a> 加载器(loader)</h3> <p>esbuild加载器的作用与webpack中loader作用类似，都是对于某种类型的文件进行编译</p> <h4 id="_1-js-loader"><a href="#_1-js-loader" class="header-anchor">#</a> 1. <a href="https://esbuild.github.io/content-types/#javascript" target="_blank" rel="noopener noreferrer">js-loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>这个加载器默认用于.js、.cjs和.mjs文件。.cjs扩展名被node用于CommonJS模块，而.mjs扩展名被node用于ECMAScript模块，尽管esbuild并没有对这两者进行区分。</p> <p>esbuild支持所有现代JavaScript语法。然而，较新的语法可能不被旧的浏览器所支持，所以你可能想配置目标选项，告诉esbuild将较新的语法转换为适当的旧语法。</p> <blockquote><p>esbuild并不支持ES5的转换，目前还不支持将ES6+语法转换为ES5。</p></blockquote> <h4 id="_2-ts-loader"><a href="#_2-ts-loader" class="header-anchor">#</a> 2. <a href="https://esbuild.github.io/content-types/#typescript" target="_blank" rel="noopener noreferrer">ts-loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p><code>.ts</code>默认情况下为、<code>.tsx</code>、<code>.mts</code>和文件启用此加载器<code>.cts</code>，这意味着 esbuild 内置支持解析 TypeScript 语法并丢弃类型注释。但是，esbuild<em>不</em>执行任何类型检查</p> <h4 id="_3-jsx-loader"><a href="#_3-jsx-loader" class="header-anchor">#</a> 3. <a href="https://esbuild.github.io/content-types/#jsx" target="_blank" rel="noopener noreferrer">jsx-loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p><a href="https://facebook.github.io/jsx/" target="_blank" rel="noopener noreferrer">JSX是 JavaScript 的类似 XML 的语法扩展，是为<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><a href="https://github.com/facebook/react" target="_blank" rel="noopener noreferrer">React<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>创建的。它旨在由您的构建工具转换为普通的 JavaScript。每个 XML 元素都成为一个普通的 JavaScript 函数调用。例如，以下 JSX 代码：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> Button <span class="token keyword">from</span> <span class="token string">'./button'</span>
<span class="token keyword">let</span> button <span class="token operator">=</span> <span class="token operator">&lt;</span>Button<span class="token operator">&gt;</span>Click me<span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span>
<span class="token function">render</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span>
</code><div class="m-mdic-copy-wrapper"><div class="u-mdic-copy-notify" id="j-notify-1726223536987-16299">成功</div><button class="u-mdic-copy-btn j-mdic-copy-btn" data-mdic-content="import Button from './button'
let button = &lt;Button&gt;Click me&lt;/Button&gt;
render(button)
" data-mdic-attach-content="" data-mdic-notify-id="j-notify-1726223536987-16299" data-mdic-notify-delay="2000" data-mdic-copy-fail-text="copy fail" onclick="!function(t){const e={copy:(t='',e='')=&gt;new Promise((c,o)=&gt;{const n=document.createElement('textarea'),d=e?`\n\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&amp;&amp;t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=&gt;{n.style.display='block',setTimeout(()=&gt;{n.style.display='none'},d)}).catch(()=&gt;{alert(i)})}};e.btnClick(t)}(this);">复制代码</button></div></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>将被转换为以下 JavaScript 代码：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> Button <span class="token keyword">from</span> <span class="token string">&quot;./button&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> button <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>Button<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;Click me&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">render</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div class="m-mdic-copy-wrapper"><div class="u-mdic-copy-notify" id="j-notify-1726223536987-18135">成功</div><button class="u-mdic-copy-btn j-mdic-copy-btn" data-mdic-content="import Button from &quot;./button&quot;;
let button = React.createElement(Button, null, &quot;Click me&quot;);
render(button);
" data-mdic-attach-content="" data-mdic-notify-id="j-notify-1726223536987-18135" data-mdic-notify-delay="2000" data-mdic-copy-fail-text="copy fail" onclick="!function(t){const e={copy:(t='',e='')=&gt;new Promise((c,o)=&gt;{const n=document.createElement('textarea'),d=e?`\n\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&amp;&amp;t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=&gt;{n.style.display='block',setTimeout(()=&gt;{n.style.display='none'},d)}).catch(()=&gt;{alert(i)})}};e.btnClick(t)}(this);">复制代码</button></div></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>.jsx和.tsx会默认开启此loader，如果你的文件是.js结尾的，那么必须手动声明loader，比如：loader: { '.js': 'jsx' },</p></blockquote> <h4 id="_4-json-loader"><a href="#_4-json-loader" class="header-anchor">#</a> 4. <a href="https://esbuild.github.io/content-types/#json" target="_blank" rel="noopener noreferrer">json-loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>对于.json文件，这个加载器是默认启用的。它在构建时将JSON文件解析成一个JavaScript对象，并将该对象作为默认导出</p> <h4 id="_5-css-loader"><a href="#_5-css-loader" class="header-anchor">#</a> 5. <a href="https://esbuild.github.io/content-types/#css" target="_blank" rel="noopener noreferrer">css-loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <h4 id="_6-text-loader"><a href="#_6-text-loader" class="header-anchor">#</a> 6. <a href="https://esbuild.github.io/content-types/#text" target="_blank" rel="noopener noreferrer">text-loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <h4 id="_7-binary-loader"><a href="#_7-binary-loader" class="header-anchor">#</a> 7. <a href="https://esbuild.github.io/content-types/#binary" target="_blank" rel="noopener noreferrer">binary-loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <h4 id="_8-base64-loader"><a href="#_8-base64-loader" class="header-anchor">#</a> 8. <a href="https://esbuild.github.io/content-types/#base64" target="_blank" rel="noopener noreferrer">Base64-loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <h4 id="_9-dataurl-loader"><a href="#_9-dataurl-loader" class="header-anchor">#</a> 9. <a href="https://esbuild.github.io/content-types/#data-url" target="_blank" rel="noopener noreferrer">dataurl-loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <h4 id="_10-file-loader"><a href="#_10-file-loader" class="header-anchor">#</a> 10. <a href="https://esbuild.github.io/content-types/#file" target="_blank" rel="noopener noreferrer">file-loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <h4 id="_11-copy-loader"><a href="#_11-copy-loader" class="header-anchor">#</a> 11. <a href="https://esbuild.github.io/content-types/#copy" target="_blank" rel="noopener noreferrer">copy-loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h4> <p>该加载程序会将文件复制到输出目录，并重写导入路径以指向复制的文件。</p> <h2 id="context-api"><a href="#context-api" class="header-anchor">#</a> Context API</h2> <p>context API 是<a href="https://github.com/evanw/esbuild/releases/tag/v0.17.0" target="_blank" rel="noopener noreferrer"><strong>esbuild v0.17.0</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>版本新加入的API，此版本不向后兼容。context函数本身可以配置<code>interface CommonOptions</code>中的所有内容</p> <p>context API 主要替换了之前可以直接使用esbuild对象调用的<code>serve</code>，<code>watch</code>等函数。现在<code>serve</code>，<code>watch</code>等函数要通过context函数调用之后的对象获取，并且他们都已<strong>异步</strong>的。</p> <ul><li><a href="https://esbuild.github.io/api/#watch" target="_blank" rel="noopener noreferrer"><strong>Watch mode</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 简单来说就是监听模式，当我们修改源文件的时候，会自动帮我们重建</li> <li><a href="https://esbuild.github.io/api/#serve" target="_blank" rel="noopener noreferrer"><strong>Serve mode</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 启动本地开发服务器，提供最新构建的结果。注意，Serve mode会自动帮我们构建打包源文件，但是并不支持热重载</li> <li><a href="https://esbuild.github.io/api/#rebuild" target="_blank" rel="noopener noreferrer"><strong>Rebuild mode</strong><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 允许手动调用构建。当将 esbuild 与其他工具集成时这非常有用。</li></ul> <p>而且在以前，esbuild是不支持<code>serve</code>，<code>watch</code>函数一起使用的，这个版本之后，允许同时使用这两个功能。主要目的，其实就是为了<strong>live load</strong>，当文件系统上的文件发生更改时，浏览器会自动重新加载页面</p> <p>esbuild是通过<a href="https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events/Using_server-sent_events" target="_blank" rel="noopener noreferrer">服务器发送事件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>来实现的<strong>live load</strong>,<strong>服务器发送事件</strong>是一种将单向消息从服务器异步传递到客户端的简单方法。服务模式现在提供一个<code>/esbuild</code>带有<code>change</code>事件的端点，每次 esbuild 的输出更改时都会触发该事件。因此，您现在可以实现简单的“实时重新加载”（即在编辑和保存文件时重新加载页面），如下所示：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">EventSource</span><span class="token punctuation">(</span><span class="token string">'/esbuild'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code><div class="m-mdic-copy-wrapper"><div class="u-mdic-copy-notify" id="j-notify-1726223536987-39609">成功</div><button class="u-mdic-copy-btn j-mdic-copy-btn" data-mdic-content="new EventSource('/esbuild').addEventListener('change', () =&gt; location.reload())
" data-mdic-attach-content="" data-mdic-notify-id="j-notify-1726223536987-39609" data-mdic-notify-delay="2000" data-mdic-copy-fail-text="copy fail" onclick="!function(t){const e={copy:(t='',e='')=&gt;new Promise((c,o)=&gt;{const n=document.createElement('textarea'),d=e?`\n\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&amp;&amp;t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=&gt;{n.style.display='block',setTimeout(()=&gt;{n.style.display='none'},d)}).catch(()=&gt;{alert(i)})}};e.btnClick(t)}(this);">复制代码</button></div></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="完整案例"><a href="#完整案例" class="header-anchor">#</a> 完整案例</h2> <p><strong>package.json</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token operator">...</span><span class="token operator">...</span>其他省略
  <span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node ./esbuild.config.js production&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node ./esbuild.config.js development&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;module&quot;</span>
<span class="token punctuation">}</span>

</code><div class="m-mdic-copy-wrapper"><div class="u-mdic-copy-notify" id="j-notify-1726223536987-44098">成功</div><button class="u-mdic-copy-btn j-mdic-copy-btn" data-mdic-content="{
  ......其他省略
  &quot;scripts&quot;: {
    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;,
    &quot;build&quot;: &quot;node ./esbuild.config.js production&quot;,
    &quot;start&quot;: &quot;node ./esbuild.config.js development&quot;
  },
  &quot;type&quot;:&quot;module&quot;
}

" data-mdic-attach-content="" data-mdic-notify-id="j-notify-1726223536987-44098" data-mdic-notify-delay="2000" data-mdic-copy-fail-text="copy fail" onclick="!function(t){const e={copy:(t='',e='')=&gt;new Promise((c,o)=&gt;{const n=document.createElement('textarea'),d=e?`\n\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&amp;&amp;t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=&gt;{n.style.display='block',setTimeout(()=&gt;{n.style.display='none'},d)}).catch(()=&gt;{alert(i)})}};e.btnClick(t)}(this);">复制代码</button></div></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>esbuild.config.js</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> esbuild <span class="token keyword">from</span> <span class="token string">&quot;esbuild&quot;</span><span class="token punctuation">;</span>

<span class="token comment">//process是一个全局对象，argv返回的是一组包含命令行参数的数组。</span>
<span class="token comment">//第一项为”node”，</span>
<span class="token comment">//第二项为执行的js的完整路径，</span>
<span class="token comment">//后面是附加在命令行后的参数</span>
<span class="token comment">//console.log(process)</span>

<span class="token keyword">const</span> productionMode <span class="token operator">=</span> <span class="token string">&quot;development&quot;</span> <span class="token operator">!==</span> process<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//console.log(productionMode);</span>

<span class="token keyword">const</span> ctx <span class="token operator">=</span> <span class="token keyword">await</span> esbuild<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 当前项目根目录</span>
  <span class="token literal-property property">absWorkingDir</span><span class="token operator">:</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment">// 输出环境 `node` 或 `browser`, 默认为 `browser`</span>
  <span class="token literal-property property">platform</span><span class="token operator">:</span> <span class="token string">&quot;browser&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 模块格式，包括`esm`、`commonjs`和`iife`</span>
  <span class="token comment">// 如果 platform 为 browser，默认为 iife；如果 platform 为 node，默认为 cjs</span>
  <span class="token literal-property property">format</span><span class="token operator">:</span> <span class="token string">&quot;esm&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 静态资源名称,可以搭配loader使用，比如 &quot;.png&quot;: &quot;file&quot;</span>
  <span class="token literal-property property">assetNames</span><span class="token operator">:</span> <span class="token string">&quot;assets/[name]-[hash]&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 入口文件名称</span>
  <span class="token comment">// entryNames: '[dir]/[name]-[hash]',</span>
  <span class="token comment">// 摇树优化,</span>
  <span class="token literal-property property">treeShaking</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// 指定 tsconfig 文件</span>
  <span class="token literal-property property">tsconfig</span><span class="token operator">:</span> <span class="token string">&quot;./tsconfig.json&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 日志级别 `silent`(默认)、`verbose`、`debug`、`info`、`warning`、`error`</span>
  <span class="token literal-property property">logLevel</span><span class="token operator">:</span> <span class="token string">&quot;info&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">//esbuild 在构建之前编辑源代码以删除某些构造,比如常见的debugger和console</span>
  <span class="token comment">//目前esbuild也仅仅提供了这两个选项</span>
  <span class="token literal-property property">drop</span><span class="token operator">:</span> productionMode <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token string">'debugger'</span><span class="token punctuation">,</span> <span class="token string">'console'</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// 入口文件列表，为一个数组</span>
  <span class="token literal-property property">entryPoints</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;src/app.tsx&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;src/index.html&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// 是否需要打包，一般设为 true</span>
  <span class="token literal-property property">bundle</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// 是否进行代码压缩</span>
  <span class="token literal-property property">minify</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token comment">// 是否生成 SourceMap 文件</span>
  <span class="token literal-property property">sourcemap</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// 指定语言版本和目标环境</span>
  <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;es2020&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;chrome58&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;firefox57&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;safari11&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// 是否生成打包的元信息文件</span>
  <span class="token literal-property property">metafile</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// 指定输出文件</span>
  <span class="token literal-property property">outdir</span><span class="token operator">:</span> productionMode <span class="token operator">?</span> <span class="token string">&quot;./public/dist/&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;./dist/&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 指定loader</span>
  <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;.html&quot;</span><span class="token operator">:</span> <span class="token string">&quot;copy&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;.svg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dataurl&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;.png&quot;</span><span class="token operator">:</span> <span class="token string">&quot;file&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// &quot;.module.css&quot;: &quot;local-css&quot;,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>productionMode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span><span class="token function">rebuild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//释放资源</span>
  ctx<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token punctuation">{</span> 
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">serve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">3000</span><span class="token punctuation">,</span>
    <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">servedir</span><span class="token operator">:</span> <span class="token string">&quot;./dist&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">server</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">server: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>server<span class="token punctuation">.</span>host<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>server<span class="token punctuation">.</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code><div class="m-mdic-copy-wrapper"><div class="u-mdic-copy-notify" id="j-notify-1726223536987-4564">成功</div><button class="u-mdic-copy-btn j-mdic-copy-btn" data-mdic-content="import esbuild from &quot;esbuild&quot;;

//process是一个全局对象，argv返回的是一组包含命令行参数的数组。
//第一项为”node”，
//第二项为执行的js的完整路径，
//后面是附加在命令行后的参数
//console.log(process)

const productionMode = &quot;development&quot; !== process.argv[2];

//console.log(productionMode);

const ctx = await esbuild.context({
  // 当前项目根目录
  absWorkingDir: process.cwd(),
  // 输出环境 `node` 或 `browser`, 默认为 `browser`
  platform: &quot;browser&quot;,
  // 模块格式，包括`esm`、`commonjs`和`iife`
  // 如果 platform 为 browser，默认为 iife；如果 platform 为 node，默认为 cjs
  format: &quot;esm&quot;,
  // 静态资源名称,可以搭配loader使用，比如 &quot;.png&quot;: &quot;file&quot;
  assetNames: &quot;assets/[name]-[hash]&quot;,
  // 入口文件名称
  // entryNames: '[dir]/[name]-[hash]',
  // 摇树优化,
  treeShaking: true,
  // 指定 tsconfig 文件
  tsconfig: &quot;./tsconfig.json&quot;,
  // 日志级别 `silent`(默认)、`verbose`、`debug`、`info`、`warning`、`error`
  logLevel: &quot;info&quot;,
  publicPath: &quot;/&quot;,
  //esbuild 在构建之前编辑源代码以删除某些构造,比如常见的debugger和console
  //目前esbuild也仅仅提供了这两个选项
  drop: productionMode ? ['debugger', 'console'] : [],
  // 入口文件列表，为一个数组
  entryPoints: [&quot;src/app.tsx&quot;, &quot;src/index.html&quot;],
  // 是否需要打包，一般设为 true
  bundle: true,
  // 是否进行代码压缩
  minify: false,
  // 是否生成 SourceMap 文件
  sourcemap: true,
  // 指定语言版本和目标环境
  target: [&quot;es2020&quot;, &quot;chrome58&quot;, &quot;firefox57&quot;, &quot;safari11&quot;],
  // 是否生成打包的元信息文件
  metafile: true,
  // 指定输出文件
  outdir: productionMode ? &quot;./public/dist/&quot; : &quot;./dist/&quot;,
  // 指定loader
  loader: {
    &quot;.html&quot;: &quot;copy&quot;,
    &quot;.svg&quot;: &quot;dataurl&quot;,
    &quot;.png&quot;: &quot;file&quot;,
    // &quot;.module.css&quot;: &quot;local-css&quot;,
  },
});

if (productionMode) {
  ctx.rebuild();
  //释放资源
  ctx.dispose();
}
else { 
  await ctx.watch();
  await ctx.serve({
    port: 3000,
    host: &quot;localhost&quot;,
    servedir: &quot;./dist&quot;,
  }).then((server) =&gt; {
    console.log(`server: ${server.host}:${server.port}`)
  }).catch((err) =&gt; process.exit(1));
}
" data-mdic-attach-content="" data-mdic-notify-id="j-notify-1726223536987-4564" data-mdic-notify-delay="2000" data-mdic-copy-fail-text="copy fail" onclick="!function(t){const e={copy:(t='',e='')=&gt;new Promise((c,o)=&gt;{const n=document.createElement('textarea'),d=e?`\n\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&amp;&amp;t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=&gt;{n.style.display='block',setTimeout(()=&gt;{n.style.display='none'},d)}).catch(()=&gt;{alert(i)})}};e.btnClick(t)}(this);">复制代码</button></div></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/advanced/esbuild/code.html" class="prev">
        代码调用
      </a></span> <span class="next"><a href="/advanced/esbuild/plugin.html">
        插件开发
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.96c97f9f.js" defer></script><script src="/assets/js/2.127a83d1.js" defer></script><script src="/assets/js/1.c207c03b.js" defer></script><script src="/assets/js/51.d23988c8.js" defer></script>
  </body>
</html>
